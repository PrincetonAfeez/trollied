<% if @trolley.orders.send("with_state_#{status}".to_sym).size > 0 -%>

  <h2><%= t("trolleys.orders.#{status}") -%></h2>

  <%= render :partial => 'orders/order',
  :collection => @trolley.orders.send("with_state_#{status}"),
  :locals => { :trolley => trolley, :status => status } -%>

<% elsif status == 'current' -%>
  <h2><%= t("trolleys.orders.current") -%></h2>
  <p><%= t("trolleys.orders.none_pending") %></p>
<% end -%>

